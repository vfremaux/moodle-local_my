define(["jquery","core/config","core/log"],function(a,b,c){var d={init:function(){a(".local-my-cat-collapse").bind("click",this.toggle_cat_state),a(".local-my-modality-chooser").bind("change",this.toggle_modality),a(".local-my-area-ctls").bind("click",this.global_area_ctl),0!==a(".is-accordion").length&&a(".local-my-course").hide(),c.debug("AMD Local my cat control initialized")},hide_home_nav:function(){a('a[data-key="home"]').css("display","none")},toggle_cat_state:function(d){d.stopPropagation(),d.preventDefault();var e=a(this),f=/local-my-cathandle-([^-]+)-([0-9]+)/,g=f.exec(e.attr("id"));if(g){var h=g[1],i=parseInt(g[2]);if(c.debug("Working for cat "+i+" in area "+h),0==e.closest(".is-accordion").length){var j=b.wwwroot+"/local/my/ajax/stateregister.php?";j+="item="+h,j+="&catid="+i;var k=a("#local-my-cathandle-"+h+"-"+i+" > h3 > button > img").attr("src"),l=0;a(".local-my-course-"+h+".cat-"+h+"-"+i).first().hasClass("collapsed")?(a(".local-my-course-"+h+".cat-"+h+"-"+i).removeClass("collapsed"),k=k.replace("collapsed","expanded"),a("#local-my-cathandle-"+h+"-"+i+" > h3 > button > img").attr("src",k),a("#local-my-cathandle-"+h+"-"+i+" > h3 > button").attr("aria-expanded","true"),c.debug("Expanding "+h+" in area "+i),l=0):(a(".local-my-course-"+h+".cat-"+h+"-"+i).addClass("collapsed"),k=k.replace("expanded","collapsed"),a("#local-my-cathandle-"+h+"-"+i+" > h3 > button > img").attr("src",k),a("#local-my-cathandle-"+h+"-"+i+" > h3 > button").attr("aria-expanded","false"),c.debug("Closing "+h+" in area "+i),l=1),j+="&hide="+l,a.get(j,function(){})}else a(".local-my-course-"+h).slideUp("normal"),a(".local-my-course-"+h+".cat-"+h+"-"+i).slideDown("normal");return!1}},toggle_modality:function(){var b=a(this),c=b.attr("id").replace("local-my-static-select-","local-my-static-modal-");a(".local-my-statictext-modals").addClass("local-my-hide"),a("#"+c+"-"+b.val()).removeClass("local-my-hide")},global_area_ctl:function(c){var d=a(this);c.stopPropagation(),c.preventDefault();var e=/local-my-cats-([^-]+)-([^-]+)$/,f=d.attr("id").match(e);if(f){var g=f[1],h=f[2],i="";return"collapseall"==g?(a(".local-my-course-"+h).addClass("collapsed"),a(".local-my-cat-collapse-"+h+" > h3 > button > img").each(function(a,b){var c=b.src;c=c.replace("expanded","collapsed"),b.src=c}),i=b.wwwroot+"/local/my/ajax/stateregister.php?",i+="item="+h,i+="&catids="+a("#local-my-areacategories-"+h).html(),i+="&what=collapseall",a.get(i)):(a(".local-my-course-"+h).removeClass("collapsed"),a(".local-my-cat-collapse-"+h+" > h3 > button > img").each(function(a,b){var c=b.src;c=c.replace("collapsed","expanded"),b.src=c}),i=b.wwwroot+"/local/my/ajax/stateregister.php?",i+="item="+h,i+="&catids="+a("#local-my-areacategories-"+h).html(),i+="&what=expandall",a.get(i)),!1}}};return d});