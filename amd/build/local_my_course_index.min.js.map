{"version":3,"file":"local_my_course_index.min.js","sources":["../src/local_my_course_index.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for controlling the sections.\n *\n * @module     block_multicourse_navigation/collapse_control\n * @package    block_multicourse_navigation\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n// jshint unused: false, undef:false\n/* eslint-disable no-undef no-unused-vars */\ndefine(['jquery', 'core/config', 'core/log'], function($, cfg, log) {\n\n    /**\n     * SectionControl class.\n     *\n     * @param {String} selector The selector for the page region containing the actions panel.\n     */\n    var localmycourseindex = {\n\n        init: function() {\n\n            // Attach delegated togglestate handler to all handles in page.\n            $('.course_category_tree').on('click', '.detail-handle', [], this.toggle_detail);\n            $('.course_category_tree').on('click', '.add-to-favorites-handle', [], this.add_to_favorites);\n            $('.course_category_tree').on('click', '.remove-from-favorites-handle', [], this.remove_from_favorites);\n\n            if ($('.is-accordion').length !== 0) {\n                // Is in accordion\n                $('.is-accordion .local-my-course').hide();\n                $('.is-accordion .local-my-cat-collapse > h3 > a').attr('aria-expanded', 'false');\n            }\n\n            // Launch lazy loading of all area place-holders.\n            $('.reload-areas').each(function() {\n                log.debug(\"Launching refresh on \" + $(this).attr('data-widget') + '-' + $(this).attr('data-uid'));\n                $(this).trigger('click');\n            });\n            this.usereloadwaiter = true;\n\n            log.debug('AMD Local My initialized');\n\n        },\n\n        add_to_favorites: function() {\n\n            var that = $(this);\n\n            var courseid = that.attr('data-course');\n            var islight = that.hasClass('light');\n\n            var url = cfg.wwwroot + '/local/my/ajax/service.php';\n            url += '?what=addtofavorites';\n            url += '&courseid=' + courseid;\n            that.removeClass('fa-star-o');\n            that.addClass('fa-star');\n            if (islight) {\n                that.removeClass('add-to-favorites-handle');\n                that.addClass('remove-from-favorites-handle');\n            }\n\n            log.debug(\"Adding course \" + courseid + \" to favorites\");\n            $.get(url);\n\n            // Find and reload favorites.\n            // DO NOT RELOAD FAVORITES ON COURSE INDEX\n        },\n\n        remove_from_favorites: function() {\n\n            var that = $(this);\n\n            var courseid = that.attr('data-course');\n            var islight = that.hasClass('light');\n\n            var url = cfg.wwwroot + '/local/my/ajax/service.php';\n            url += '?what=removefromfavorites';\n            url += '&courseid=' + courseid;\n\n            log.debug(\"Removing course \" + courseid + \" from favorites\");\n            $.get(url);\n\n            // find on screen icon-favorites of this course and change class.\n            $('.icon-favorite[data-course=\"' + courseid + '\"]').removeClass('fa-star');\n            $('.icon-favorite[data-course=\"' + courseid + '\"]').addClass('fa-star-o');\n            if (islight) {\n                that.removeClass('fa-star');\n                that.addClass('fa-star-o');\n                that.removeClass('remove-from-favorites-handle');\n                that.addClass('add-to-favorites-handle');\n            }\n\n            // Find and reload favorites.\n            // DO NOT RELOAD FAVORITES ON COURSE INDEX\n        }\n\n    };\n\n    return localmycourseindex;\n\n});\n"],"names":["define","$","cfg","log","init","on","this","toggle_detail","add_to_favorites","remove_from_favorites","length","hide","attr","each","debug","trigger","usereloadwaiter","that","courseid","islight","hasClass","url","wwwroot","removeClass","addClass","get"],"mappings":";;;;;;;AAwBAA,wCAAO,CAAC,SAAU,cAAe,aAAa,SAASC,EAAGC,IAAKC,WAOlC,CAErBC,KAAM,WAGFH,EAAE,yBAAyBI,GAAG,QAAS,iBAAkB,GAAIC,KAAKC,eAClEN,EAAE,yBAAyBI,GAAG,QAAS,2BAA4B,GAAIC,KAAKE,kBAC5EP,EAAE,yBAAyBI,GAAG,QAAS,gCAAiC,GAAIC,KAAKG,uBAE/C,IAA9BR,EAAE,iBAAiBS,SAEnBT,EAAE,kCAAkCU,OACpCV,EAAE,iDAAiDW,KAAK,gBAAiB,UAI7EX,EAAE,iBAAiBY,MAAK,WACpBV,IAAIW,MAAM,wBAA0Bb,EAAEK,MAAMM,KAAK,eAAiB,IAAMX,EAAEK,MAAMM,KAAK,aACrFX,EAAEK,MAAMS,QAAQ,iBAEfC,iBAAkB,EAEvBb,IAAIW,MAAM,6BAIdN,iBAAkB,eAEVS,KAAOhB,EAAEK,MAETY,SAAWD,KAAKL,KAAK,eACrBO,QAAUF,KAAKG,SAAS,SAExBC,IAAMnB,IAAIoB,QAAU,6BACxBD,KAAO,uBACPA,KAAO,aAAeH,SACtBD,KAAKM,YAAY,aACjBN,KAAKO,SAAS,WACVL,UACAF,KAAKM,YAAY,2BACjBN,KAAKO,SAAS,iCAGlBrB,IAAIW,MAAM,iBAAmBI,SAAW,iBACxCjB,EAAEwB,IAAIJ,MAMVZ,sBAAuB,eAEfQ,KAAOhB,EAAEK,MAETY,SAAWD,KAAKL,KAAK,eACrBO,QAAUF,KAAKG,SAAS,SAExBC,IAAMnB,IAAIoB,QAAU,6BACxBD,KAAO,4BACPA,KAAO,aAAeH,SAEtBf,IAAIW,MAAM,mBAAqBI,SAAW,mBAC1CjB,EAAEwB,IAAIJ,KAGNpB,EAAE,+BAAiCiB,SAAW,MAAMK,YAAY,WAChEtB,EAAE,+BAAiCiB,SAAW,MAAMM,SAAS,aACzDL,UACAF,KAAKM,YAAY,WACjBN,KAAKO,SAAS,aACdP,KAAKM,YAAY,gCACjBN,KAAKO,SAAS"}